"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _cb=function(){function i(){this.__=0}return i.get=function(t,e,n){var r,o=i._pools;return 0<o.length?(r=o[o.length-1],o.pop()):r=new i,r.thisobj=e,r.f=t,r.args=n,r.__=1,r},i.free=function(t){return 1==t.__&&(t.__=0,t.args=null,t.f=null,t.thisobj=null,i._pools.push(t),!0)},i.run=function(t){return 0==t.__?null:t.f.apply(t.thisobj,t.args)},i.run_=function(t){return t.f.apply(t.thisobj,t.args)},i.run2free=function(t){if(0==t.__)return null;var e=t.f.apply(t.thisobj,t.args);return t.__=0,t.args=null,t.f=null,t.thisobj=null,i._pools.push(t),e},i._pools=[],i}();exports._cb=_cb,Object.defineProperty(exports,"__esModule",{value:!0});var _cb_1=require("./_cb"),_cbs=function(){function t(){this._s=[],this._l=0}return t.prototype.add=function(t,e,n){if(null!=this.get(t,e))return!1;var r=_cb_1._cb.get(e,t,n);return this._s.push(r),!0},t.prototype.add_=function(t,e,n){var r=_cb_1._cb.get(e,t,n);this._s.push(r)},t.prototype.get=function(t,e){for(var n=this._s,r=n.length-1;0<=r;r--){var o=n[r];if(o.f==t&&o.thisobj==e)return o}return o},t.prototype.callLater=function(){var t=this._s,e=t.length;if(0<e){this._l=e;for(var n=0;n<e;n++)_cb_1._cb.run2free(t[n]);t.splice(0,e),this._l=0}},t.prototype.cbFrame=function(){var t=this._s,e=null;return 0<t.length&&(e=_cb_1._cb.run2free(t[0]),t.splice(0,1)),e},t.prototype.reset=function(){for(var t=this._s,e=t.length-1;0<=e;e--)_cb_1._cb.free(t[e]);t.length=0},t.prototype.size=function(){return this._s.length},t}();exports._cbs=_cbs,Object.defineProperty(exports,"__esModule",{value:!0});var _dd=function(t,e){this.n=t,this.s=e,this.d=this};exports._dd=_dd,Object.defineProperty(exports,"__esModule",{value:!0});var _lang=function(){function t(){this._strs=new Object,this._i=["{0}","{1}","{2}","{3}","{4}","{5}"]}return t.prototype.setLang=function(t){var e=this;if(e.langName!=t){var n=e._strs[t];if(null!=n)return e._obj=n,e.langName=t,!0}return!1},t.prototype.get=function(t){return this._strs[t]},t.prototype.add=function(t,e){this._strs[t]=e},t.prototype.tr=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this._obj[t];if(!r)return t;for(var o=e.length,i=0;i<o;i++)r=r.replace(this._i[i],e[i]);return r},t}();exports._lang=_lang,Object.defineProperty(exports,"__esModule",{value:!0});var _mem=function(){function t(){}return t.lang_zh={1001:"这是1001错误"},t.lang_en={1001:"this is 1001 error"},t}();exports._mem=_mem,Object.defineProperty(exports,"__esModule",{value:!0});var _time=function(){function t(){this.fps=60,this.frameCount=0,this.startTime=0,this.time=0,this.realtime=0,this.deltaTime=0,this._last=0,this.scale=1,this._f=0,this._t=0}return t.prototype.frame=function(t){var e=this,n=t-e._last,r=n;return n<1?n=1:1e4<n&&(n=1e4),e.frameCount++,e.realtime=e.realtime+n,e._last=t,n*=e.scale,e.deltaTime=n,e.time=e.time+n,n=t-e._t,e._f++,500<=n&&(e.fps=1e3*e._f/n,e._f=0,e._t=t),r},t.prototype.start=function(t){0==this.startTime&&(this.startTime=t,this._last=t)},t}();exports._time=_time,Object.defineProperty(exports,"__esModule",{value:!0});var Spool_1=require("./Spool"),Ilog_1=require("./Ilog"),Entity_1=require("./Entity"),Stask_1=require("./Stask"),_cbs_1=require("./_cbs"),_mem_1=require("./_mem"),Tool_1=require("./Tool"),_lang_1=require("./_lang"),_time_1=require("./_time"),ECS=function(){function s(){}return s.start=function(t){if(!s.isStart){s.isStart=!0;var e=Date.now();s.log=new Ilog_1.Ilog,s.pool=new Spool_1.Spool,s.time=new _time_1._time,s.task=new Stask_1.Stask,s.later=new _cbs_1._cbs,s.lang=new _lang_1._lang,s.event=new Entity_1.Entity,s.lang.add(s.zh_CN,_mem_1._mem.lang_zh),s.lang.add(s.en_US,_mem_1._mem.lang_en),s.time.start(e),s._update(),setInterval(s._update,t),e=Date.now()-e,s.log.info("ecs init complete,task:"+e+"ms")}},s._update=function(){var t=s.time,e=new Date;s.date=Tool_1.Tool.date_day(e,""),s.datetime=Tool_1.Tool.date_time(e);var n=e.getTime();t.frame(n);s.later.callLater(),s.task._update(t.time,t.deltaTime)},s.setTimeOut=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=s.pool._getTask(t,e,r);return i.period=n,i.restCount=1,i.start(n,!1),i},s.setInterval=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=s.pool._getTask(t,e,r);return i.period=n,i.start(n,!1),i},s.callLater=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return s.later.add(t,e,n)},s.LOG_NO=0,s.LOG_ERROR=1,s.LOG_WARN=2,s.LOG_INFO=3,s.LOG_DEBUG=4,s.STATUS_INIT=0,s.STATUS_RELEASE=1,s.STATUS_WORK=2,s.STATUS_ON=3,s.en_US="en_US",s.zh_CN="zh_CN",s.isStart=!1,s.debug=!1,s.handNull=function(){},s}();exports.ECS=ECS;var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var ECS_1=require("./ECS"),Ievent_1=(_cbs_1=require("./_cbs"),require("./Ievent")),EventID_1=require("./EventID"),Entity=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.coms=[],t._later=new _cbs_1._cbs,t._enabled=!0,t}return __extends(t,e),t.prototype.callLater=function(t,e,n){var r=this._later;r.get(t,e)||(r.add(e,t,n),ECS_1.ECS.callLater(r.callLater,r))},t.prototype.reset=function(){this.callComs("reset"),this._later.reset(),e.prototype.reset.call(this)},t.prototype.setScript=function(t,e){this.coms[t]=e},t.prototype.callComs=function(n){this.coms.forEach(function(t){var e=t[n];null!=e&&e()})},t.prototype.setEnabled=function(t){this._enabled!=t&&(this._enabled=t,this.sendEventD(EventID_1.EventID.enabled_change,t,this))},t}(Ievent_1.Ievent);exports.Entity=Entity,Object.defineProperty(exports,"__esModule",{value:!0});var _dd_1=require("./_dd"),EventID=function(){function t(){}return t.enabled_change=new _dd_1._dd(101,"enabled_change"),t.init=101,t.update=102,t.destroy=103,t.add=1,t.remove=2,t.change=3,t.resize=4,t}();exports.EventID=EventID,Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"__esModule",{value:!0});var Ievent=function(){function t(){this._stop=!1,this._evts=new Object,this._evtid=[]}return t.prototype.addEvent=function(t,e){var n=this._evts[t];if(null==n)n=[],this._evts[t]=n,this._evtid.push(t);else if(0<=n.indexOf(e))return;n.push(e)},t.prototype.remEvent=function(t,e){var n=this._evts[t];if(null!=n&&0<n.length){if(null==e)return!(n.length=0);var r=n.indexOf(e);if(0<=r)return n.splice(r,1),!0}return!1},t.prototype.getEvent=function(t){return this._evts[t]},t.prototype.sendEvent=function(t,e,n){var r=this;r.target=n;var o=r._evts[t];if(null!=o&&0<o.length){r._stop=!1;for(var i=0;i<o.length;i++)if(o[i](t,e,r),r._stop)return}},t.prototype.sendEventD=function(t,e,n){this.sendEvent(t.n,e,n)},t.prototype.stop=function(){this._stop=!0},t.prototype.reset=function(){var t=this._evtid;if(0<t.length){for(var e=t.length-1;0<=e;e--)this._evts[t[e]].length=0;t.length=0}},t}();exports.Ievent=Ievent,Object.defineProperty(exports,"__esModule",{value:!0});ECS_1=require("./ECS");var Ilog=function(){function t(){this.type={1:" [error]\t",2:" [warn]\t",3:" [info]\t",4:" [debug]\t"},this.level=4,this.log=function(t,e){t<=this.level&&console.log(ECS_1.ECS.datetime+this.type[t]+e.join(" "))}}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(4,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(3,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(2,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(1,t)},t.NO=0,t.ERROR=1,t.WARN=2,t.INFO=3,t.DEBUG=4,t}();exports.Ilog=Ilog,Object.defineProperty(exports,"__esModule",{value:!0});var Inode=function(){function t(){}return t.prototype.remove=function(){null!=this.list&&this.list.remove(this)},t}();exports.Inode=Inode,Object.defineProperty(exports,"__esModule",{value:!0});var Inodelist=function(){function t(){this.size=0}return t.prototype.moveTo=function(t){var e=this;if(0<e.size){t.end=e.end,0==t.size?(t.start=e.start,t.size=e.size):t.size=t.size+e.size;var n=e.start;n.prev=t.end;for(var r=n;null!=r;)n=r.next,r.list=t,r=n;e.start=null,e.end=null,e.size=0}},t.prototype.clear=function(t){var e=this;if(0<e.size){for(var n=e.start,r=null;null!=n;)r=n.next,n.list=null,n.prev=null,(n.next=null)!=t&&t(n),n=r;e.start=null,e.end=null,e.size=0}},t.prototype.unshift=function(t){var e=this,n=e.start;return t!=n&&(t.remove(),null!=n?((t.next=n).prev=t,e.start=t,e.size=e.size+1):this.push_(e,t),!0)},t.prototype.push=function(t){return t.list!=this&&(t.remove(),this.push_(this,t),!0)},t.prototype.push_=function(t,e){t.size=t.size+1,null==(e.list=t).start?(t.start=e).prev=null:(t.end.next=e).prev=t.end,e.next=null,t.end=e},t.prototype.remove=function(t){var e=t.list;if(e!=this)return!1;e.size=e.size-1,t.list=null;var n=t.prev,r=t.next;return null==n?e.start=r:(n.next=r,t.prev=null),null==r?e.end=n:(r.prev=n,t.next=null),!0},t.prototype.getIndex=function(t){if(t.list!=this)return-1;for(var e=0,n=t.prev;null!=n;)e++,n=n.prev;return e},t.prototype.getAt=function(t){var e,n=this.size;if(t<0||n<=t)return null;var r=0;if(t<.5*n)for(e=this.start;r<t;r++)e=e.next;else for(e=this.end,r=n-1;t<r;r--)e=e.prev;return e},t.prototype.pop=function(){if(0<this.size){var t=this.end;if(this.remove(t))return t}return null},t.prototype.shift=function(){if(0<this.size){var t=this.start;if(this.remove(t))return t}return null},t.prototype.insert=function(t,e){var n=e.list;return n==this&&(t.remove(),n.start!=e?e.prev.next=t:n.start=t,t.prev=e.prev,t.next=e,t.list=n,e.prev=t,n.size=n.size+1,!0)},t}();exports.Inodelist=Inodelist,Object.defineProperty(exports,"__esModule",{value:!0});var Inode_1=require("./Inode"),Inodelist_1=require("./Inodelist"),Ipool=function(){function t(){this.pool=new Inodelist_1.Inodelist,this.max=0}return t.prototype.init=function(t,e,n){this.name=t,this.max=e,this.classType=n},t.prototype.clear=function(){this.pool.clear(this._destroy)},t.prototype._destroy=function(t){var e=t.udata;null!=e&&e.reset()},t.prototype._creat=function(){var t=new Inode_1.Inode,e=new this.classType;return(e._pool=t).udata=e,t},t.prototype.fill=function(t){var e=this;0<e.max&&t>e.max&&(t=e.max);for(var n=e.pool.size;n<t;n++)e.pool.push(e._creat())},t.prototype.free=function(t){var e=this,n=t._pool;return n.list!=e.pool&&(t.reset(),(0==e.max||e.pool.size<e.max)&&e.pool.push(n))},t.prototype.malloc=function(){var t=this.pool.pop();return null==t&&(t=this._creat()),t.udata},t}();exports.Ipool=Ipool,Object.defineProperty(exports,"__esModule",{value:!0});ECS_1=require("./ECS");var Iscript=function(){function t(){this.reset=ECS_1.ECS.handNull}return t.prototype.exec=function(t){var e=this[t];if(null!=e)return e()},t.prototype.on=function(t,e){this[t]=e},t}();exports.Iscript=Iscript,Object.defineProperty(exports,"__esModule",{value:!0});ECS_1=require("./ECS"),_cb_1=require("./_cb");var Itask=function(){function t(){this._nextExecTime=0,this.period=0,this.restCount=-1,this.status=0,this.autoDestroy=!0}return t.prototype.reset=function(){var t=this;0!=t.status&&(t.status=0,t.period=0,t.restCount=-1,t.autoDestroy=!0,_cb_1._cb.free(t.cb),(t.cb=null)!=t.complete&&(_cb_1._cb.free(t.complete),t.complete=null))},t.prototype.sleep=function(t){2==this.status&&ECS_1.ECS.task.extask(this,t)},t.prototype.setcb=function(t){var e=this.cb;this.cb=t,null!=e&&e!=t&&_cb_1._cb.free(e),this.status=null!=t?1:0},t.prototype.setComplete=function(t){if(0==this.status)return!1;var e=this.complete;return this.complete=t,null!=e&&e!=t&&_cb_1._cb.free(e),!0},t.prototype.stop=function(){2==this.status&&(this.status=3)},t.prototype.start=function(t,e){var n=this.status;return 0!=n&&(!!(1==n||3==n||2==n&&e)&&(this.status=2,ECS_1.ECS.task.extask(this,t),!0))},t.INIT=0,t.REM=1,t.WORK=2,t.CANCEL=3,t}();exports.Itask=Itask,Object.defineProperty(exports,"__esModule",{value:!0});var Sdata=function(){function t(){this._d={},this._disableId=[]}return t.prototype.add=function(t,e){e.instid=t;var n=this._d[t];null!=n&&console.error(this+" has save data by id:"+t+"="+n),this._d[t]=n},t.prototype.get=function(t){return this._d[t]},t}();exports.Sdata=Sdata,Object.defineProperty(exports,"__esModule",{value:!0});var Ipool_1=require("./Ipool"),Itask_1=(Inode_1=require("./Inode"),Inodelist_1=require("./Inodelist"),Entity_1=require("./Entity"),require("./Itask")),Spool=(EventID_1=require("./EventID"),_cb_1=require("./_cb"),function(){function r(){this.com_id=0,this.com_pool=[],this._task=new Inodelist_1.Inodelist,this._ent=new Inodelist_1.Inodelist,this._instid=0}return r.prototype.addPoolComp=function(t,e,n,r){var o=new Ipool_1.Ipool;o.init(e,r,n);for(var i=0;i<t.length;i++)null!=this.com_pool[t[i]]&&console.error("pool has data with comid : "+t[i]),this.com_pool[t[i]]=o;return o},r.prototype.makePoolCompId=function(){var t=this.com_id;return this.com_id=t+1,t},r.prototype._getTask=function(t,e,n){var r,o=_cb_1._cb.get(t,e,n),i=this._task.pop();return null==i?(r=new Itask_1.Itask,((i=new Inode_1.Inode).udata=r)._pool=i):r=i.udata,r.status=0,r.setcb(o),i.udata},r.prototype.remTask=function(t){return t.reset(),2!=t.status&&(this._task.push(t._pool),!0)},r.prototype._remTaskByNode=function(t){t.udata.reset(),this._task.push(t)},r.prototype.getTaskPoolSize=function(){return this._task.size},r.prototype.remEntity=function(t){return t._pool.list!=this._ent&&(t.reset(),t._pool.remove(),this._ent.push_(this._ent,t._pool),!0)},r.prototype.newEntity=function(){var t,e=this._ent.pop();if(null==e){e=new Inode_1.Inode,((t=new Entity_1.Entity)._pool=e).udata=t;var n=this._instid+1;this._instid=n,t.instid=n}else t=e.udata;return t.sendEvent(EventID_1.EventID.init,t,r),t},r.prototype.addComp=function(t,e){var n=e.coms[t];return null==n&&(n=this.com_pool[t].malloc(),(e.coms[t]=n).ent=e,n.onuse()),n},r.prototype.remComp=function(t,e){var n=e.coms[t];return null!=n&&(this.com_pool[t].free(n),n.ent=null,!(e.coms[t]=null))},r}());exports.Spool=Spool,Object.defineProperty(exports,"__esModule",{value:!0});Inodelist_1=require("./Inodelist"),ECS_1=require("./ECS"),_cb_1=require("./_cb");var Stask=function(){function t(){this._waitTime=0,this._task=new Inodelist_1.Inodelist,this._needSort=!1}return t.prototype._update=function(t,e){var n=this;0<n._waitTime?n._waitTime=n._waitTime-e:(this._onexec(n._task,t),n._task.size)},t.prototype.dosort=function(t){t.start,t.size,ECS_1.ECS.pool},t.prototype._onexec=function(t,e){1==this._needSort&&(this._needSort=!1);for(var n,r=t.start,o=t.size,i=ECS_1.ECS.pool,s=0,u=_cb_1._cb.run_,a=0;a<o;a++){var l=r.udata;if(n=r.next,2==l.status?e>=l._nextExecTime&&(l._nextExecTime=l._nextExecTime+l.period,-1==(s=l.restCount)?u(l.cb):0<s&&(s-=1,0==(l.restCount=s)?(l.status=3,u(l.cb),null!=l.complete&&u(l.complete)):u(l.cb))):l.autoDestroy?i._remTaskByNode(l._pool):t.remove(r),null==(r=n)||0<this._waitTime)return}},t.prototype.running=function(){return this._waitTime<1},t.prototype.sleep=function(t){this._waitTime=t},t.prototype.extask=function(t,e){return this._needSort=!0,t._nextExecTime=ECS_1.ECS.time.time+e,this._task.push(t._pool)},t.prototype.sort=function(){this._needSort=!0},t.prototype.clear=function(){var t=ECS_1.ECS.pool;this._task.clear(t._remTaskByNode.bind(t))},t.prototype.size=function(){return this._task.size},t}();exports.Stask=Stask,Object.defineProperty(exports,"__esModule",{value:!0});var Tool=function(){function o(){}return o.str_replaceAll=function(t,e,n){var r=t.indexOf(e);if(r<0)return t;for(var o="",i=0,s=e.length;0<=r;)o=o+t.substring(i,r)+n,i=r+s,r=t.indexOf(e,i);return o+=t.substring(i)},o.str_add=function(t,e,n,r){var o=t.length;if(e<=o)return t;var i=n.length;if(r)for(;o<e;o+=i)t=n+t;else for(;o<e;o+=i)t+=n;return t},o.str_format=function(t,e,n){for(var r=e.length;n<r;n++)t=o.str_replaceAll(t,"{"+n+"}",e[n]);return t},o.str_format2=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o.str_format(t,e,0)},o.shuf=function(t){for(var e=t.length,n=e-1;0<=n;n--){var r=t[n],o=Math.floor(Math.random()*e);t[n]=t[o],t[o]=r}},o.copy=function(t,e){e.length=0;for(var n=t.length-1;0<=n;n--)e[n]=t[n];return e},o.date_day=function(t,e){var n=t.getFullYear()+e,r=t.getMonth()+1,o=t.getDate();return r<10?n=n+"0"+r:n+=r,n+=e,o<10?n=n+"0"+o:n+=o,n},o.date_time=function(t){var e="",n=t.getHours(),r=t.getMinutes(),o=t.getSeconds(),i=t.getMilliseconds();return n<10?e=e+"0"+n:e+=n,e+=":",r<10?e=e+"0"+r:e+=r,e+=":",o<10?e=e+"0"+o:e+=o,e+=".",i<10?e=e+"00"+i:i<100?e=e+"0"+i:e+=i,e},o.size_1024b=function(t,e){if(t<1024)return t+"B";var n=1024;return t<1024*n?(t/n).toFixed(e)+"KB":t<1024*(n*=1024)?(t/n).toFixed(e)+"MB":t<1024*(n*=1024)?(t/n).toFixed(e)+"GB":(t/(n*=1024)).toFixed(e)+"TB"},o}();exports.Tool=Tool,Object.defineProperty(exports,"__esModule",{value:!0});var Transition=function(){function r(){}return r.linear_none=function(t,e,n){return e*t+n},r.quad_in=function(t,e,n){return e*t*t+n},r.quad_out=function(t,e,n){return e*t*(2-t)+n},r.quad_both=function(t,e,n){return t<.5?2*e*t*t+n:e*(2*t*(2-t)-1)+n},r.cubic_in=function(t,e,n){return e*t*t*t+n},r.cubic_out=function(t,e,n){return e*(--t*t*t+1)+n},r.cubic_both=function(t,e,n){return t<.5?4*e*t*t*t+n:e*(4*--t*t*t+1)+n},r.quart_in=function(t,e,n){return e*t*t*t*t+n},r.quart_out=function(t,e,n){return e*(1- --t*t*t*t)+n},r.quart_both=function(t,e,n){return t<.5?8*e*t*t*t*t+n:e*(1-8*--t*t*t*t)+n},r.quint_in=function(t,e,n){return e*t*t*t*t*t+n},r.quint_out=function(t,e,n){return e*(--t*t*t*t*t+1)+n},r.quint_both=function(t,e,n){return t<.5?16*e*t*t*t*t*t+n:e*(16*--t*t*t*t*t+1)+n},r.sine_in=function(t,e,n){return e-e*Math.cos(t*r._pi2)+n},r.sine_out=function(t,e,n){return e*Math.sin(t*r._pi2)+n},r.sine_both=function(t,e,n){return.5*e*(1-Math.cos(Math.PI*t))+n},r.expo_in=function(t,e,n){return 0==t?n:e*Math.pow(2,10*(t-1))+n},r.expo_out=function(t,e,n){return 1==t?e+n:e*(1-Math.pow(2,-10*t))+n},r.expo_both=function(t,e,n){return 0==t?n:1==t?e+n:t<.5?.5*e*Math.pow(2,20*t-10)+n:.5*e*(2-Math.pow(2,10-20*t))+n},r.circ_in=function(t,e,n){return e*(1-Math.sqrt(1-t*t))+n},r.circ_out=function(t,e,n){return e*Math.sqrt((2-t)*t)+n},r.circ_both=function(t,e,n){return t<.5?.5*e*(1-Math.sqrt(1-4*t*t))+n:(t=2*t-2,.5*e*(Math.sqrt(1-t*t)+1)+n)},r.elastic_in=function(t,e,n){return 0==t?n:1==t?e+n:-e*Math.pow(2,10*t-10)*Math.sin((3.33*t-3.58)*r._2pi)+n},r.elastic_out=function(t,e,n){return 0==t?n:1==t?e+n:e*(Math.pow(2,-10*t)*Math.sin((3.33*t-.25)*r._2pi)+1)+n},r.elastic_both=function(t,e,n){return 0==t?n:1==t?e+n:t<.5?.5*-e*Math.pow(2,20*t-10)*Math.sin((4.45*t-2.475)*r._2pi)+n:e*(Math.pow(2,10-20*t)*Math.sin((4.45*t-2.475)*r._2pi)*.5+1)+n},r.back_in=function(t,e,n){return e*t*t*(2.70158*t-1.70158)+n},r.back_out=function(t,e,n){return e*(--t*t*(2.70158*t+1.70158)+1)+n},r.back_both=function(t,e,n){return t<.5?e*t*t*(14.379636*t-5.189818)+n:e*(--t*t*(14.379636*t+5.189818)+1)+n},r.bounce_in=function(t,e,n){return.636364<t?e*(1-7.5625*(t=1-t)*t)+n:.27273<t?e*(.25-7.5625*(t=.454546-t)*t)+n:.090909<t?e*(.0625-7.5625*(t=.181818-t)*t)+n:e*(.015625-7.5625*(t=.045455-t)*t)+n},r.bounce_out=function(t,e,n){return t<.363636?7.5625*e*t*t+n:t<.72727?e*(7.5625*(t-=.545454)*t+.75)+n:t<.909091?e*(7.5625*(t-=.818182)*t+.9375)+n:e*(7.5625*(t-=.954545)*t+.984375)+n},r.bounce_both=function(t,e,n){return t<.045455?e*(.007813-3.78125*(t=.045455-2*t)*t)+n:t<.136365?e*(.03125-3.78125*(t=.181818-2*t)*t)+n:t<.318182?e*(.125-3.78125*(t=.454546-2*t)*t)+n:t<.5?e*(.5-3.78125*(t=1-2*t)*t)+n:t<.681818?e*(3.78125*(t=2*t-1)*t+.5)+n:t<.863635?e*(3.78125*(t=2*t-1.545454)*t+.875)+n:t<.954546?e*(3.78125*(t=2*t-1.818182)*t+.96875)+n:e*(3.78125*(t=2*t-1.954545)*t+.992188)+n},r.q_bezier=function(t,e,n,r){return(1-t)*(1-t)*n+2*t*(1-t)*e+t*t*r},r._pi2=.5*Math.PI,r._2pi=2*Math.PI,r}();exports.Transition=Transition,Object.defineProperty(exports,"__esModule",{value:!0});var uintc=function(){function o(){}return o.prototype.init=function(t){this.value=0,this.add(t)},o.prototype.add=function(t){var e=this,n=t/32>>0;n*=32;var r=e.key!=n;return r&&(e.key=n,e.value=0),n=t-e.key,e.value=1<<n|e.value,r},o.decode=function(t,e){for(var n=0;n<t.length;n+=2)for(var r=t[n],o=t[n+1],i=0;i<32;i++)1==(o>>i&1)&&e.push(i+r)},o.compress_uint=function(t,e){if(0!=t.length){t.sort();var n=o.uc;n.init(t[0]),e.push(n.key),e.push(n.value);for(var r=0;r<t.length;r++)n.add(t[r])?(e.push(n.key),e.push(n.value)):e[e.length-1]=n.value}},o.compress_uint_add=function(t,e){var n=o.uc;n.init(e);var r=t.indexOf(n.key)+1;0<r?(n.value=t[r],n.add(e),t[r]=n.value):(t.push(n.key),t.push(n.value))},o.uc=new o,o}();exports.uintc=uintc;